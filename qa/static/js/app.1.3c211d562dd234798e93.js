(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{137:function(e,t,n){"use strict";(function(e){var r=n(1),o=n(416),s=n(186);function i(){return r.createElement("div",{className:s.pageLoading},r.createElement("div",{className:s.spinBox},r.createElement(o.ClipLoader,{className:s.spin,sizeUnit:"px",size:66,color:"#586663",loading:!0})))}!function(){var t=n(16).enterModule;t&&t(e)}();const a=i;t.a=a,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(i,"PageLoading","C:/project/svn/svn/web2-react/src/components/PageLoading/index.tsx"),t.register(a,"default","C:/project/svn/svn/web2-react/src/components/PageLoading/index.tsx"),r(e))}()}).call(this,n(44)(e))},179:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(3),s=n(59),i=n(38),a=n(49),c=n(43),u=n(20),p=n(22);!function(){var t=n(16).enterModule;t&&t(e)}();var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editorState=null,t.setEditorState=function(e){t.editorState=e},t.resetEditorState=function(){Object(o.runInAction)(function(){t.editorState=null,console.log(t.editorState)})},t.sendMessage=function(e,n){return r.b(t,void 0,Promise,function(){var t,o;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),t=void 0,1!==n?[3,2]:[4,this.api.single.messagesWritten(e)];case 1:return t=r.sent(),[3,4];case 2:return[4,this.api.group.groupWritten(e)];case 3:t=r.sent(),r.label=4;case 4:return console.log(t),[3,6];case 5:return o=r.sent(),console.error(o),[3,6];case 6:return[2]}})})},t.messagesImgMsg=function(e){return r.b(t,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),(t=new FormData).append("userid",u.a.usersIndex.id),1===p.a.chatType.conversationType?t.append("friendid",e.friendid):t.append("groupid",e.groupid),t.append("file",e.file),1!==p.a.chatType.conversationType?[3,2]:[4,this.api.single.messagesImgMsg(t)];case 1:return n.sent(),[3,4];case 2:return[4,this.api.group.groupImgMsg(t)];case 3:n.sent(),n.label=4;case 4:return[3,6];case 5:return n.sent(),[3,6];case 6:return[2]}})})},t.login=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.login(e)];case 1:return t=r.sent(),console.log(t),Object(a.d)(c.a.TOKEN,t.token),localStorage.setItem(c.b.USERINFO,JSON.stringify(t)),i.routerStore.replace("/"),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t}return r.d(t,e),r.c([o.observable],t.prototype,"editorState",void 0),r.c([o.action],t.prototype,"setEditorState",void 0),r.c([o.action],t.prototype,"resetEditorState",void 0),r.c([o.action],t.prototype,"sendMessage",void 0),r.c([o.action],t.prototype,"messagesImgMsg",void 0),r.c([o.action],t.prototype,"login",void 0),t}(s.b);const l=new d;t.a=l,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(d,"MessageStore","C:/project/svn/svn/web2-react/src/store/messageStore/index.ts"),t.register(l,"default","C:/project/svn/svn/web2-react/src/store/messageStore/index.ts"),r(e))}()}).call(this,n(44)(e))},186:function(e,t,n){e.exports={pageLoading:"ZbrATjg_tt8MPYxcomz9w","spin-box":"FuSzEOu-G_dWN0ku_6k0x",spinBox:"FuSzEOu-G_dWN0ku_6k0x",spin:"_2xn6ZFnNUmfGKjYts-fqD4"}},187:function(e,t,n){e.exports={centered:"_1Pb_YPy676dVNBrGJ2B1fC",emoji:"_1J6Ao3Ne1sQxLR_8CECkqI",title:"_2JaRclWo2z-t0tnIVfZYvK"}},19:function(e,t,n){"use strict";(function(e){var r,o=n(2),s=n(178),i=n.n(s),a=n(419),c=n(80),u=n.n(c),p=(n(260),n(49));!function(){var t=n(16).enterModule;t&&t(e)}(),function(e){e[e.LOGICERROR=0]="LOGICERROR",e[e.TIMEOUTERROR=1]="TIMEOUTERROR",e[e.NETWORKERROR=2]="NETWORKERROR"}(r||(r={}));var d=[2018,401,402,403,1004],l={baseURL:"https://kaixinliao.com/api/"},g={},f=["get","post","put","delete"],v=null,h=function(e){return e.result||e.data||{}};f.forEach(function(e){g[e]=function(t,n,s){var c={method:e,url:t,baseURL:s||l.baseURL,headers:{SIGN:""+Object(p.c)().sign}},g=i.a.create(l);return g.interceptors.request.use(function(e){var t={ts:Date.now()/1e3};return e.params=o.a({},e.params,t),e},function(e){return Promise.reject(e)}),g.interceptors.response.use(function(e){var t=null;if("object"==typeof e.data&&2018===e.data.code){var n={msg:e.data.msg,type:r[r.LOGICERROR],config:e.config},o=JSON.parse(localStorage.getItem("userInfo"));Math.round((new Date).getTime()),o.date;return window.clearTimeout(v),v=window.setTimeout(function(){location.replace("/#/login")},0),Promise.reject(n)}if("object"==typeof e.data&&1004===e.data.code){n={msg:e.data.msg,type:r[r.LOGICERROR],config:e.config};var s=JSON.parse(localStorage.getItem("userInfo")).date;Math.round((new Date).getTime());return window.clearTimeout(v),v=window.setTimeout(function(){location.replace("/#/login")},0),Promise.reject(n)}if("object"!=typeof e.data||200!==e.data.code){n={msg:e.data.msg,type:r[r.LOGICERROR],config:e.config};return Promise.reject(n)}return t=e.data,h(t)},function(e){if(d.includes(e.response.status))return u.a.destroy(),u.a.error("用户认证失败! 请登录重试..."),window.clearTimeout(v),void(v=window.setTimeout(function(){location.replace("/#/login")},300));var t={msg:e.response.statusText||e.message||"网络故障",type:/^timeout of/.test(e.message)?r[r.TIMEOUTERROR]:r[r.NETWORKERROR],config:e.config};return Promise.reject(t)}),"get"===e?c.params=n:n instanceof FormData?c.data=n:c.data=a.stringify(n),c.startTime=new Date,g.request(c).then(function(e){return e}).catch(function(e){return u.a.destroy(),u.a.error(e.response||e.msg||e.stack||"未知错误"),c.url.includes("autoScript.set")?Promise.resolve({err:e}):Promise.reject({err:e,stack:e.msg||e.stack||""})})}});const I=g;t.a=I,function(){var t=n(16).default,o=n(16).leaveModule;t&&(t.register(r,"HTTPERROR","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(d,"TOKENERROR","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(l,"DEFAULTCONFIG","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(g,"http","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(f,"methods","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(v,"authTimer","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(h,"resFormat","C:/project/svn/svn/web2-react/src/services/http.ts"),t.register(I,"default","C:/project/svn/svn/web2-react/src/services/http.ts"),o(e))}()}).call(this,n(44)(e))},20:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(3),s=n(59),i=n(49),a=n(38),c=n(22);!function(){var t=n(16).enterModule;t&&t(e)}();var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.usersIndex={id:"",nickname:"",phone:"",portraitUri:"",role:""},t.usersDatas={account:"",id:"",nickname:"",phone:"",portraitUri:""},t.groupInfo={id:"",name:"",phone:"",portraitUri:"",role:"",creatorId:"",maxMemberCount:"",memberCount:""},t.groupInfo2={id:"",name:"",portraitUri:"",creatorId:"",maxMemberCount:"",memberCount:"",createdAt:"",bulletin:"",deletedAt:""},t.usersBlacklist=[],t.friendshipAll=[],t.groupsGroupUser=[],t.usersGroups=[],t.friendApplyList=[],t.friendStatus=!1,t.groupsMembers=[],t.at=[],t.friendid="",t.addFriendStatus=!1,t.Notification=[],t.imgUrl="",t.fileUrl="",t.base="",t.isUserGroupEnd=!1,t.refreshusersIndex=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.user.usersIndex(Object(i.c)().id)];case 1:return e=n.sent(),Object(o.runInAction)("SET_USER_Index",function(){t.usersIndex=e}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.refreshusersBlacklist=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.user.usersBlacklist({userid:Object(i.c)().id})];case 1:return e=n.sent(),Object(o.runInAction)("SET_USER_Blacklist",function(){t.usersBlacklist=e}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.goBack=function(){history.back()},t.refreshfriendshipAll=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.user.friendshipAll({userid:Object(i.c)().id})];case 1:return e=n.sent(),Object(o.runInAction)("SET_USER_FriendshipAll",function(){console.log(e);var n=[];e.forEach(function(e){"1"===e.status&&n.push(e)}),t.friendshipAll=n,localStorage.setItem("friendshipAll",JSON.stringify(t.friendshipAll.slice()))}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.refreshusersGroups=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.usersGroups=[],[4,this.api.group.usersGroups({userid:Object(i.c)().id})];case 1:return e=n.sent(),Object(o.runInAction)("SET_USER_usersGroups",function(){for(var n in console.log(e),e)if(e.hasOwnProperty(n)){var o=e[n];console.log(o),t.usersGroups.push(r.a({role:o.role},o.group))}t.isUserGroupEnd=!0,console.log(t.usersGroups),localStorage.setItem("usersGroups",JSON.stringify(t.usersGroups.slice()))}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.refreshfriendApplyList=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.user.friendApplyList({userid:Object(i.c)().id})];case 1:return e=n.sent(),Object(o.runInAction)("SET_USER_friendApplyList",function(){t.friendApplyList=e}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.getUsers=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){try{this.refreshusersIndex(),this.getNotification({userId:JSON.parse(localStorage.getItem("userInfo")).id,type:2}),this.refreshusersBlacklist(),this.refreshfriendshipAll(),this.refreshfriendApplyList(),this.refreshusersGroups().then(function(){c.a.initSdk()})}catch(e){}return[2]})})},t.referAt=function(){t.at=[]},t.setAt=function(e){t.at=e},t.groupsMember=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=[],[4,this.api.group.groupsMembers(e).then(function(e){e.forEach(function(e){t.push({displayName:e.displayName,id:e.user.id,nickname:e.user.nickname}),console.log(t),Object(o.runInAction)(function(){n.groupsMembers=t})})})];case 1:return r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.loadfriendslist=function(){return r.b(t,void 0,void 0,function(){var e,t,n,s=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.api.user,t=Object(i.c)().id,[4,e.friendshipAll({userid:t})];case 1:return n=r.sent(),Object(o.runInAction)("SET_FRIENDSLIST",function(){s.friendshipAll=n}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.resetfriendStatus=function(){Object(o.runInAction)("SET_FRIENDSSTATUS",function(){t.friendStatus=!1,t.addFriendStatus=!1,t.friendid="",t.friendIndex=null})},t.setNotification=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){try{this.api.single.setNotification(e).then(function(){t.getNotification({userId:t.usersIndex.id,type:2})})}catch(e){}return[2]})})},t.getNotification=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.single.getNotification(e)];case 1:return t=r.sent(),Object(o.runInAction)(function(){console.log(t),2===e.type&&(n.Notification=t,c.a.GetConversationsList())}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.uploadImg=function(e){return r.b(t,void 0,void 0,function(){var t,n,s=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.imgUrl="",this.base="",(t=new FormData).append("file",e.file),[4,this.api.user.uploadImg(t)];case 1:return n=r.sent(),Object(o.runInAction)(function(){s.imgUrl=n.imgUrl,s.base=n.base}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.uploadFile=function(e){return r.b(t,void 0,void 0,function(){var t,n,s=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=new FormData).append("file",e.file),[4,this.api.user.uploadFile(t)];case 1:return n=r.sent(),Object(o.runInAction)(function(){console.log(n.fileUrl),s.fileUrl=n.fileUrl}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.changeState=function(){return r.b(t,void 0,void 0,function(){var e=this;return r.e(this,function(t){try{Object(o.runInAction)("SET_FRIENDS",function(){e.friendStatus=!e.friendStatus})}catch(e){Object(o.runInAction)("SET_FRIENDS",function(){})}return[2]})})},t.addGagUser=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsaddGagUser(e)];case 1:return t=r.sent(),Object(o.runInAction)("addGagUser",function(){c.a.groupsMember(c.a.chatType.targetId),n.$message.success("禁言成功!"),console.log(t)}),[3,3];case 2:return r.sent(),Object(o.runInAction)("addGagUser",function(){}),[3,3];case 3:return[2]}})})},t.rollBackGagUser=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.group.groupsrollBackGagUser(e)];case 1:return n.sent(),Object(o.runInAction)("rollBackGagUser",function(){c.a.groupsMember(c.a.chatType.targetId),t.$message.success("解除禁言成功!")}),[3,3];case 2:return n.sent(),Object(o.runInAction)("rollBackGagUser",function(){}),[3,3];case 3:return[2]}})})},t.addblacklist=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.auth.addblacklist(e)];case 1:return n.sent(),Object(o.runInAction)("addblacklist",function(){t.$message.success("添加黑名单成功"),t.refreshusersBlacklist(),t.refreshfriendshipAll()}),[3,3];case 2:return n.sent(),Object(o.runInAction)("addblacklist",function(){}),[3,3];case 3:return[2]}})})},t.usersData=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.usersIndex(e)];case 1:return t=r.sent(),Object(o.runInAction)("usersData",function(){n.usersDatas=t}),[3,3];case 2:return r.sent(),Object(o.runInAction)("usersData",function(){}),[3,3];case 3:return[2]}})})},t.removeblacklist=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.auth.removeblacklist(e)];case 1:return n.sent(),Object(o.runInAction)("removeblacklist",function(){t.$message.success("移除黑名单成功"),t.refreshusersBlacklist(),t.refreshfriendshipAll()}),[3,3];case 2:return n.sent(),Object(o.runInAction)("removeblacklist",function(){}),[3,3];case 3:return[2]}})})},t.checkMessage=function(){return r.b(t,void 0,void 0,function(){var e;return r.e(this,function(t){switch(t.label){case 0:return e=1===c.a.chatType.conversationType?1:2,[4,this.api.user.checkMessage({userid:this.usersIndex.id,status:e,toformid:c.a.chatType.targetId})];case 1:return[2,t.sent()]}})})},t.updatedisplayName=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.api.user.updatedisplayName(e)];case 1:return t=s.sent(),Object(o.runInAction)("removeFriend",function(){n.$message.success("设置好友备注成功!"),console.log(c.a.ConversationsList),c.a.chatType=r.a({},c.a.chatType,{nickname:e.displayname});var o=c.a.ConversationsList.find(function(e){return e.targetId===c.a.chatType.targetId});console.log(o),o=r.a({},o,{nickname:e.displayname}),c.a.refreshConversationsList(o,!0),n.refreshfriendshipAll(),console.log(t)}),[3,3];case 2:return s.sent(),Object(o.runInAction)("removeFriend",function(){}),[3,3];case 3:return[2]}})})},t.removeFriend=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.removeFriend(e)];case 1:return t=r.sent(),Object(o.runInAction)("removeFriend",function(){n.$message.success("删除好友成功!"),console.log(t)}),[3,3];case 2:return r.sent(),Object(o.runInAction)("removeFriend",function(){}),[3,3];case 3:return[2]}})})},t.goOneKeyGroup=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){try{a.routerStore.history.push("/OneKeyGroup")}catch(e){a.routerStore.history.goBack()}return[2]})})},t.groupsQuit=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsQuit(e)];case 1:return t=r.sent(),Object(o.runInAction)("groupsQuit",function(){a.routerStore.history.goBack(),c.a.deleteConvList(3,c.a.chatType.targetId),n.refreshusersGroups(),n.$message.success("退出群组成功!"),console.log(t)}),[3,3];case 2:return r.sent(),Object(o.runInAction)("groupsQuit",function(){}),[3,3];case 3:return[2]}})})},t.gotoPush=function(e){try{a.routerStore.history.push(e)}catch(e){}},t.groupsGroupUsers=function(){return r.b(t,void 0,void 0,function(){var e,t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.group.groupsGroupUser({userid:this.usersIndex.id,groupid:c.a.chatType.targetId})];case 1:return e=n.sent(),Object(o.runInAction)("groupsGroupUsers",function(){t.groupsGroupUser=e.user}),[3,3];case 2:return n.sent(),Object(o.runInAction)("groupsGroupUsers",function(){}),[3,3];case 3:return[2]}})})},t.groupsDismiss=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.api.group.groupsDismiss(e)];case 1:return n.sent(),Object(o.runInAction)("groupsDismiss",function(){a.routerStore.history.goBack(),c.a.deleteConvList(3,c.a.chatType.targetId),t.refreshusersGroups(),t.$message.success("退出群组成功!")}),[3,3];case 2:return n.sent(),Object(o.runInAction)("groupsDismiss",function(){}),[3,3];case 3:return[2]}})})},t.groupsJoin=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsJoin(e)];case 1:return t=r.sent(),Object(o.runInAction)("GROUP_JOIN",function(){console.log(t),n.$message.success("邀请成功!"),c.a.groupsMember(c.a.chatType.targetId),n.refreshusersGroups()}),[3,3];case 2:return r.sent(),Object(o.runInAction)("GROUP_CREATE",function(){}),[3,3];case 3:return[2]}})})},t.groupsCreate=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupsCreate(e)];case 1:return t=r.sent(),Object(o.runInAction)("GROUP_CREATE",function(){n.groupid=t,n.$message.success("创建成功!"),n.refreshusersGroups()}),[3,3];case 2:return r.sent(),Object(o.runInAction)("GROUP_CREATE",function(){}),[3,3];case 3:return[2]}})})},t.resetUsersDatas=function(){t.usersDatas={account:"",id:"",nickname:"",phone:"",portraitUri:""}},t.refresh=function(e){return r.b(t,void 0,void 0,function(){var t,n,s=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=new FormData,console.log(e.name),console.log(e.file),t.append("userid",this.usersIndex.id),e.name&&t.append("name",e.name),e.file&&t.append("file",e.file),e.account&&t.append("account",e.account),[4,this.api.auth.refresh(t)];case 1:return n=r.sent(),Object(o.runInAction)(function(){console.log(n),s.refreshusersIndex(),e.name&&s.$message.success("修改昵称成功"),e.file&&s.$message.success("修改头像成功"),e.account&&s.$message.success("修改账号成功")}),[3,3];case 2:return r.sent(),Object(o.runInAction)(function(){}),[3,3];case 3:return[2]}})})},t.groupsRefresh=function(e){return r.b(t,void 0,void 0,function(){var t,n,s,i=this;return r.e(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=new FormData,console.log(e.groupname),console.log(e.file),console.log(e.bulletin),console.log(c.a.chatType.targetId),n=e.groupname||c.a.chatType.nickname,t.append("groupid",c.a.chatType.targetId),t.append("groupname",n),e.file&&t.append("file",e.file),e.bulletin&&t.append("bulletin",e.bulletin),[4,this.api.group.groupsRefresh(t)];case 1:return s=a.sent(),Object(o.runInAction)(function(){console.log(s),i.refreshusersGroups().then(function(){i.refreshGroupInfo(c.a.chatType.targetId)}),e.groupname&&c.a.setChatType(r.a({},c.a.chatType,{nickname:e.groupname})),e.bulletin&&i.groupsNoticeRefresh(c.a.chatType.targetId),i.$message.success("修改成功")}),[3,3];case 2:return a.sent(),Object(o.runInAction)(function(){}),[3,3];case 3:return[2]}})})},t.groupsNoticeRefresh=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),console.log(e),[4,this.api.group.groupsGroupInfo(e)];case 1:return t=r.sent(),Object(o.runInAction)("groupsNoticeRefresh",function(){console.log(t),n.groupInfo2=t}),[3,3];case 2:return r.sent(),Object(o.runInAction)("groupsNoticeRefresh",function(){}),[3,3];case 3:return[2]}})})},t.refreshGroupInfo=function(e){try{var n=JSON.parse(localStorage.getItem("usersGroups")).find(function(t){return t.id===e});t.groupInfo=n,c.a.setChatType(r.a({},c.a.chatType,{portraitUri:n.portraitUri}))}catch(e){}},t.queryFriendship=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.queryFriendship(e)];case 1:return t=r.sent(),Object(o.runInAction)("SET_FRIENDS",function(){n.addFriendStatus=!1,n.friendStatus=!0,n.friendid=t.id,n.friendIndex=t}),[3,3];case 2:return r.sent(),Object(o.runInAction)("SET_FRIENDSSTATUS",function(){n.friendStatus=!1}),[3,3];case 3:return[2]}})})},t.addFriendship=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.addFriendship(e)];case 1:return t=r.sent(),Object(o.runInAction)("SET_ADDSTATUS",function(){n.addFriendStatus=!0}),console.log(t),[3,3];case 2:return r.sent(),Object(o.runInAction)("SET_ADDSTATUS",function(){n.addFriendStatus=!1}),[3,3];case 3:return[2]}})})},t}return r.d(t,e),r.c([o.observable],t.prototype,"usersIndex",void 0),r.c([o.observable],t.prototype,"usersDatas",void 0),r.c([o.observable],t.prototype,"groupInfo",void 0),r.c([o.observable],t.prototype,"groupInfo2",void 0),r.c([o.observable],t.prototype,"usersBlacklist",void 0),r.c([o.observable],t.prototype,"friendshipAll",void 0),r.c([o.observable],t.prototype,"groupsGroupUser",void 0),r.c([o.observable],t.prototype,"usersGroups",void 0),r.c([o.observable],t.prototype,"friendApplyList",void 0),r.c([o.observable],t.prototype,"friendStatus",void 0),r.c([o.observable],t.prototype,"friendIndex",void 0),r.c([o.observable],t.prototype,"groupsMembers",void 0),r.c([o.observable],t.prototype,"at",void 0),r.c([o.observable],t.prototype,"friendid",void 0),r.c([o.observable],t.prototype,"addFriendStatus",void 0),r.c([o.observable],t.prototype,"Notification",void 0),r.c([o.observable],t.prototype,"groupid",void 0),r.c([o.observable],t.prototype,"imgUrl",void 0),r.c([o.observable],t.prototype,"fileUrl",void 0),r.c([o.observable],t.prototype,"base",void 0),r.c([o.observable],t.prototype,"isUserGroupEnd",void 0),r.c([o.action],t.prototype,"refreshusersIndex",void 0),r.c([o.action],t.prototype,"refreshusersBlacklist",void 0),r.c([o.action],t.prototype,"goBack",void 0),r.c([o.action],t.prototype,"refreshfriendshipAll",void 0),r.c([o.action],t.prototype,"refreshusersGroups",void 0),r.c([o.action],t.prototype,"refreshfriendApplyList",void 0),r.c([o.action],t.prototype,"getUsers",void 0),r.c([o.action],t.prototype,"referAt",void 0),r.c([o.action],t.prototype,"setAt",void 0),r.c([o.action],t.prototype,"groupsMember",void 0),r.c([o.action],t.prototype,"loadfriendslist",void 0),r.c([o.action],t.prototype,"resetfriendStatus",void 0),r.c([o.action],t.prototype,"setNotification",void 0),r.c([o.action],t.prototype,"getNotification",void 0),r.c([o.action],t.prototype,"uploadImg",void 0),r.c([o.action],t.prototype,"uploadFile",void 0),r.c([o.action],t.prototype,"changeState",void 0),r.c([o.action],t.prototype,"addGagUser",void 0),r.c([o.action],t.prototype,"rollBackGagUser",void 0),r.c([o.action],t.prototype,"addblacklist",void 0),r.c([o.action],t.prototype,"usersData",void 0),r.c([o.action],t.prototype,"removeblacklist",void 0),r.c([o.action],t.prototype,"checkMessage",void 0),r.c([o.action],t.prototype,"updatedisplayName",void 0),r.c([o.action],t.prototype,"removeFriend",void 0),r.c([o.action],t.prototype,"goOneKeyGroup",void 0),r.c([o.action],t.prototype,"groupsQuit",void 0),r.c([o.action],t.prototype,"gotoPush",void 0),r.c([o.action],t.prototype,"groupsGroupUsers",void 0),r.c([o.action],t.prototype,"groupsDismiss",void 0),r.c([o.action],t.prototype,"groupsJoin",void 0),r.c([o.action],t.prototype,"groupsCreate",void 0),r.c([o.action],t.prototype,"resetUsersDatas",void 0),r.c([o.action],t.prototype,"refresh",void 0),r.c([o.action],t.prototype,"groupsRefresh",void 0),r.c([o.action],t.prototype,"groupsNoticeRefresh",void 0),r.c([o.action],t.prototype,"refreshGroupInfo",void 0),r.c([o.action],t.prototype,"queryFriendship",void 0),r.c([o.action],t.prototype,"addFriendship",void 0),t}(s.b);const p=new u;t.a=p,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(u,"UserStore","C:/project/svn/svn/web2-react/src/store/userStore/index.ts"),t.register(p,"default","C:/project/svn/svn/web2-react/src/store/userStore/index.ts"),r(e))}()}).call(this,n(44)(e))},22:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(3),s=n(59),i=n(96),a=n.n(i),c=(n(304),n(43)),u=n(20),p=n(38),d=n(49);!function(){var t=n(16).enterModule;t&&t(e)}();var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfo=null,t.ConversationsList=[],t.TopConversationsList=[],t.MessagesList=[],t.chatType=JSON.parse(localStorage.getItem("chatType"))||null,t.activeChat=!1,t.unreadMessageCount=0,t.unreadCount=0,t.timestamp=0,t.hasMsg=!0,t.initEnd=!1,t.initSdk=function(){var e=localStorage.getItem(c.b.USERINFO);if(e){var n=JSON.parse(e);t.init(n.appkey),t.setConnectionStatusListener(),t.setOnReceiveMessageListener(),t.connect(n.token),RongIMLib.RongIMEmoji.init(),RongIMLib.RongIMVoice.init(),t.innerHeight=window.innerHeight}},t.init=function(e){RongIMLib.RongIMClient.init(e,null,{})},t.setConnectionStatusListener=function(){RongIMLib.RongIMClient.setConnectionStatusListener({onChanged:function(e){switch(e){case RongIMLib.ConnectionStatus.CONNECTED:console.log("链接成功"),t.GetConversationsList(),t.getTotalUnreadCount(),Object(o.runInAction)(function(){t.initEnd=!0});break;case RongIMLib.ConnectionStatus.CONNECTING:console.log("正在链接");break;case RongIMLib.ConnectionStatus.DISCONNECTED:console.log("断开连接"),t.reconnect();break;case RongIMLib.ConnectionStatus.KICKED_OFFLINE_BY_OTHER_CLIENT:console.log("其他设备登录"),t.$message.error("其他设备登录"),p.routerStore.replace("/login");break;case RongIMLib.ConnectionStatus.DOMAIN_INCORRECT:console.log("域名不正确");break;case RongIMLib.ConnectionStatus.NETWORK_UNAVAILABLE:console.log("网络不可用"),t.reconnect()}}})},t.setOnReceiveMessageListener=function(){try{RongIMLib.RongIMClient.setOnReceiveMessageListener({onReceived:function(e){return r.b(t,void 0,void 0,function(){var t,n,s,i,c,p,d,l,g,f,v,h,I=this;return r.e(this,function(b){switch(b.label){case 0:switch(console.log(e),e.targetId===this.chatType.targetId&&this.activeChat&&this.clearUnreadCount({conversationType:e.conversationType,targetId:e.targetId}),e.objectName){case"RC:TxtMsg":return[3,1];case"RC:ImgMsg":case"RC:FileMsg":case"RC:InfoNtf":case"RC:VcMsg":return[3,2];case"RC:ImgTextMsg":return[3,13];case"RC:RcCmd":return[3,14];case"RC:LBSMsg":return[3,15];case"RC:SightMsg":return[3,16];case"RC:ProfileNtf":return[3,17];case"RC:CmdNtf":return[3,18];case"RC:GrpNtf":return[3,19];case"RC:ReadNtf":return[3,20];case"RC:ContactNtf":return[3,21]}return[3,22];case 1:console.log(RongIMLib.RongIMEmoji.symbolToEmoji(e.content.content)),console.log(RongIMLib.RongIMEmoji.emojiToHTML(e.content.content)),b.label=2;case 2:switch(c=this.ConversationsList.slice().findIndex(function(t){return t.targetId===e.targetId}),p=-1!==c?this.ConversationsList[c].unreadMessageCount:0,console.log(this.ConversationsList[c]),e.messageDirection){case 1:return[3,3];case 2:return[3,4]}return[3,11];case 3:switch(e.conversationType){case 1:if(g=JSON.parse(localStorage.getItem("friendshipAll")),s=g.findIndex(function(t){return t.user.id===e.targetId}),console.log(s),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,messageUId:e.messageUId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:0},n=r.a({},i,{portraitUri:u.a.usersIndex.portraitUri,nickname:u.a.usersIndex.nickname}),-1!==c){if(t=r.a({},i,{portraitUri:g[s].user.portraitUri,nickname:g[s].user.nickname}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(n)}else this.api.user.usersIndex(e.targetId).then(function(o){t=r.a({},i,{portraitUri:o.portraitUri,nickname:o.nickname}),I.refreshConversationsList(t,!1),I.chatType&&I.chatType.targetId!==e.targetId||I.pullMessage(n)});break;case 3:if(f=JSON.parse(localStorage.getItem("usersGroups")),s=f.findIndex(function(t){return t.id===e.targetId}),console.log(s),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,messageUId:e.messageUId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:0},n=r.a({},i,{portraitUri:u.a.usersIndex.portraitUri,nickname:u.a.usersIndex.nickname}),-1!==c){if(t=r.a({},i,{portraitUri:f[s].portraitUri,nickname:f[s].name}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(n)}else this.api.group.groupsGroupInfo(e.targetId).then(function(o){t=r.a({},i,{portraitUri:o.portraitUri,nickname:o.name}),I.refreshConversationsList(t,!1),I.chatType&&I.chatType.targetId!==e.targetId||I.pullMessage(n)})}return[3,12];case 4:switch(Object(o.runInAction)(function(){e.targetId!==I.chatType.targetId&&I.unreadCount++}),e.conversationType){case 1:return[3,5];case 3:return[3,6]}return[3,9];case 5:if(l=JSON.parse(localStorage.getItem("friendshipAll")),g=l.find(function(t){return t.user.id===e.targetId}),console.log(s),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,messageUId:e.messageUId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:e.targetId!==this.chatType.targetId?++p:p},g){if(console.log("friendshipAll存在"),console.log(g),n=r.a({},i,{portraitUri:g.user.portraitUri,nickname:""!==g.displayName?g.displayName:g.user.nickname}),t=r.a({},i,{portraitUri:g.user.portraitUri,nickname:""!==g.displayName?g.displayName:g.user.nickname}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(n)}else this.api.user.usersIndex(e.targetId).then(function(o){n=r.a({},i,{portraitUri:o.portraitUri,nickname:o.nickname}),t=r.a({},i,{portraitUri:o.portraitUri,nickname:o.nickname}),I.refreshConversationsList(t,!1),I.chatType&&I.chatType.targetId!==e.targetId||I.pullMessage(n)});return[3,10];case 6:return f=JSON.parse(localStorage.getItem("usersGroups")),v=f.find(function(t){return t.id===e.targetId}),d=JSON.parse(localStorage.getItem("groupsMembers"+e.targetId)),console.log(d),d?[3,8]:[4,this.groupsMember(e.targetId)];case 7:b.sent(),d=JSON.parse(localStorage.getItem("groupsMembers"+e.targetId)),b.label=8;case 8:if(console.log(this.activeChat),i={conversationType:e.conversationType,content:e.content,messageDirection:e.messageDirection,senderUserId:e.senderUserId,messageUId:e.messageUId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:e.targetId!==this.chatType.targetId?++p:p},console.log(e.content),d.forEach(function(t){console.log(t),t.id===e.senderUserId&&(console.log(t),n=r.a({},i,{portraitUri:t.portraitUri,nickname:t.nickname}))}),v){if(t=r.a({},i,{portraitUri:v.portraitUri,nickname:v.name}),this.refreshConversationsList(t,!1),this.chatType&&this.chatType.targetId!==e.targetId)return[2];this.pullMessage(n)}else this.api.group.groupsGroupInfo(e.targetId).then(function(o){t=r.a({},i,{portraitUri:o.portraitUri,nickname:o.name}),I.refreshConversationsList(t,!1),I.chatType&&I.chatType.targetId!==e.targetId||I.pullMessage(n)});return[3,10];case 9:return[3,10];case 10:case 11:return[3,12];case 12:case 13:return[3,23];case 14:return console.log(e.messageUId),[2,-1===(h=this.MessagesList.findIndex(function(t){return t.messageUId===e.content.messageUId}))?Object(o.runInAction)(function(){-1!==h&&I.MessagesList.splice(h,1)}):null];case 15:case 16:case 17:case 18:return[3,23];case 19:switch(console.log(JSON.parse(e.content.data)),e.content.operation){case"Create":this.GetConversationsList();break;case"Rename":break;case"Add":case"Kicked":this.groupsMember(e.targetId)}return[3,23];case 20:return[3,23];case 21:switch(e.content.operation){case"Request":a.a.open({message:"您有一个新的待添加好友",description:"附加信息: "+e.content.message,duration:3}),u.a.refreshfriendApplyList();break;case"AcceptResponse":a.a.open({message:"接受好友",description:""+e.content.message,duration:3}),u.a.refreshfriendApplyList(),u.a.refreshfriendshipAll();break;case"RejectResponse":a.a.open({message:"拒绝好友",description:""+e.content.message,duration:3})}return[3,23];case 22:return[3,23];case 23:return[2]}})})}})}catch(e){t.$message.error("监听异常，返回登录页"),p.routerStore.replace("/login")}},t.connect=function(e){RongIMLib.RongIMClient.connect(e,{onSuccess:function(e){console.log("链接成功，用户id："+e)},onTokenIncorrect:function(){console.log("token无效")},onError:function(e){console.log(e)}})},t.GetConversationsList=function(){return RongIMLib.RongIMClient.getInstance().getConversationList({onSuccess:function(e){console.log(e),Object(o.runInAction)("RESET_CONVERLIST",function(){t.ConversationsList=[],t.TopConversationsList=[],t.unreadCount=0});var n=JSON.parse(localStorage.getItem("friendshipAll")),r=JSON.parse(localStorage.getItem("usersGroups"));e.forEach(function(e){switch(console.log(e.objectName),e.objectName){case"RC:TxtMsg":case"RC:ImgMsg":case"RC:FileMsg":case"RC:VcMsg":t.getUnreadCount({conversationType:e.conversationType,targetId:e.latestMessage.targetId});case"RC:InfoNtf":var s,i={conversationType:e.conversationType,content:e.latestMessage.content,messageDirection:e.latestMessage.messageDirection,senderUserId:e.latestMessage.senderUserId,targetId:e.targetId,sentTime:e.latestMessage.sentTime,unreadMessageCount:e.unreadMessageCount,messageId:e.latestMessage.messageId,isTop:e.isTop};switch(e.conversationType){case 1:if(n)try{var a=n.find(function(t){return t.user.id===e.targetId});console.log(a),s=Object.assign(i,{nickname:""!==a.displayName?a.displayName:a.user.nickname},{portraitUri:a.user.portraitUri}),console.log(s),Object(o.runInAction)("SET_CONVLIST",function(){var e=u.a.Notification.findIndex(function(e){return e.targetId===s.targetId});console.log(e),-1===e?t.ConversationsList.push(s):t.TopConversationsList.push(s),console.log(t.ConversationsList)})}catch(n){t.deleteConvList(1,e.targetId)}else t.api.single.usersIndex(e.targetId).then(function(e){s=Object.assign(i,{nickname:e.nickname},{portraitUri:e.portraitUri}),console.log(s),Object(o.runInAction)("SET_CONVLIST",function(){var e=u.a.Notification.findIndex(function(e){return e.targetId===s.targetId});console.log(e),-1===e?t.ConversationsList.push(s):t.TopConversationsList.push(s),console.log(t.ConversationsList)})}).catch(function(n){t.deleteConvList(1,e.targetId)});break;case 3:if(r)try{a=r.find(function(t){return t.id===e.targetId});console.log(a),s=Object.assign(i,{nickname:a.name},{portraitUri:a.portraitUri}),Object(o.runInAction)("SET_CONVLIST",function(){var e=u.a.Notification.findIndex(function(e){return e.targetId===s.targetId});console.log(e),-1===e?t.ConversationsList.push(s):t.TopConversationsList.push(s)})}catch(n){t.deleteConvList(3,e.targetId)}else t.api.group.groupsGroupInfo(e.targetId).then(function(e){s=Object.assign(i,{nickname:e.name},{portraitUri:e.portraitUri}),Object(o.runInAction)("SET_CONVLIST",function(){var e=u.a.Notification.findIndex(function(e){return e.targetId===s.targetId});console.log(e),-1===e?t.ConversationsList.push(s):t.TopConversationsList.push(s)})}).catch(function(n){console.log(n),t.deleteConvList(3,e.targetId)})}break;case"RC:ContactNtf":case"RC:ProfileNtf":case"RC:CmdNtf":case"RC:GrpNtf":case"RC:ReadNtf":case"RC:PSCmd":case"RC:CmdMsg":t.deleteConvList(e.conversationType,e.targetId)}})},onError:function(e){}},null,null,null),t.ConversationsList},t.sendTFileMessageSDK=function(e,n,o){return r.b(t,void 0,void 0,function(){var t,s,i,a=this;return r.e(this,function(c){return""===u.a.fileUrl?[2]:(t=new RongIMLib.FileMessage({name:e.name,size:e.size,type:e.type,fileUrl:u.a.fileUrl}),s=n||this.chatType.conversationType,i=o||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(s,i,t,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});a.pushMessage(t)},onError:function(e){var t="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:t="超时";break;case RongIMLib.ErrorCode.UNKNOWN:t="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:t="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:t="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:t="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:t="不在聊天室中"}console.log("发送失败:"+t),a.$message.error("发送失败:  "+t),history.back()},onBefore:function(e){}}),[2])})})},t.sendTImgMessageSDK=function(e,n,o){return r.b(t,void 0,void 0,function(){var e,t,s,i=this;return r.e(this,function(a){return""===u.a.imgUrl||""===u.a.base?[2]:(e=new RongIMLib.ImageMessage({content:u.a.base,imageUri:u.a.imgUrl}),t=n||this.chatType.conversationType,s=o||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(t,s,e,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});i.pushMessage(t)},onError:function(e,t){var n="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:n="超时";break;case RongIMLib.ErrorCode.UNKNOWN:n="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:n="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:n="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:n="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:n="不在聊天室中"}console.log("发送失败:"+n),i.$message.error("发送失败:  "+n),history.back()},onBefore:function(e){console.log(111,e)}}),[2])})})},t.sendTextMessageSDK=function(e,n,o){return r.b(t,void 0,void 0,function(){var t,s,i,a=this;return r.e(this,function(c){return console.log(e),""===e?[2]:(t=new RongIMLib.TextMessage({content:RongIMLib.RongIMEmoji.symbolToEmoji(e),extra:{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri}}),s=n||this.chatType.conversationType,i=o||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(s,i,t,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});a.pushMessage(t)},onError:function(e,t){console.log("error",t);var n="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:n="超时";break;case RongIMLib.ErrorCode.UNKNOWN:n="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:n="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:n="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:n="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:n="不在聊天室中"}console.log("发送失败:"+n),a.$message.error("发送失败:  "+n),history.back()},onBefore:function(e){console.log(111,e)}}),[2])})})},t.sendGroupsTextMessageSDK=function(e,n,s,i){return r.b(t,void 0,void 0,function(){var t,a,c,p=this;return r.e(this,function(d){return t=new RongIMLib.TextMessage({content:e,extra:{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri}}),a=s||this.chatType.conversationType,c=i||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(a,c,t,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});Object(o.runInAction)(function(){p.MessagesList.push(t)}),p.refreshConversationsList1(t,n)},onError:function(e,t){console.log("error",t);var n="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:n="超时";break;case RongIMLib.ErrorCode.UNKNOWN:n="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:n="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:n="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:n="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:n="不在聊天室中"}console.log("发送失败:"+n),p.$message.error("发送失败:  "+n)},onBefore:function(e){console.log(111,e)}}),[2]})})},t.sendGroupsmentionedsMessageSDK=function(e,n,s,i,a,c){return r.b(t,void 0,void 0,function(){var t,p,d,l,g=this;return r.e(this,function(f){return t=a||this.chatType.conversationType,p=c||this.chatType.targetId,(d=new RongIMLib.MentionedInfo).type=s?RongIMLib.MentionedType.ALL:RongIMLib.MentionedType.PART,s||(d.userIdList=i),l=new RongIMLib.TextMessage({content:e,extra:{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri},mentionedInfo:d}),RongIMLib.RongIMClient.getInstance().sendMessage(t,p,l,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});Object(o.runInAction)(function(){g.MessagesList.push(t)}),g.refreshConversationsList1(t,n)},onError:function(e,t){console.log("error",t);var n="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:n="超时";break;case RongIMLib.ErrorCode.UNKNOWN:n="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:n="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:n="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:n="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:n="不在聊天室中"}console.log("发送失败:"+n),g.$message.error("发送失败:  "+n)},onBefore:function(e){console.log(111,e)}},!0),[2]})})},t.sendInforMessageSDK=function(e,n,o){return r.b(t,void 0,void 0,function(){var t,s,i,a=this;return r.e(this,function(c){return t=new RongIMLib.InformationNotificationMessage({message:e,extra:{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri}}),s=n||this.chatType.conversationType,i=o||this.chatType.targetId,RongIMLib.RongIMClient.getInstance().sendMessage(s,i,t,{onSuccess:function(e){console.log("Send successfully",e);var t=r.a({},e,{nickname:u.a.usersIndex.nickname,portraitUri:u.a.usersIndex.portraitUri});a.pushMessage(t)},onError:function(e,t){console.log("error",t);var n="";switch(e){case RongIMLib.ErrorCode.TIMEOUT:n="超时";break;case RongIMLib.ErrorCode.UNKNOWN:n="未知错误";break;case RongIMLib.ErrorCode.REJECTED_BY_BLACKLIST:n="在黑名单中，无法向对方发送消息";break;case RongIMLib.ErrorCode.NOT_IN_DISCUSSION:n="不在讨论组中";break;case RongIMLib.ErrorCode.NOT_IN_GROUP:n="不在群组中";break;case RongIMLib.ErrorCode.NOT_IN_CHATROOM:n="不在聊天室中"}console.log("发送失败:"+n),a.$message.error("发送失败:  "+n),history.back()},onBefore:function(e){console.log(111,e)}}),[2]})})},t.groupsMember=function(e){return r.b(t,void 0,void 0,function(){var t;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=[],[4,this.api.group.groupsMembers(e).then(function(n){console.log(n),n.forEach(function(n){console.log(n),t.push(r.a({srole:n.role,displayName:n.displayName,isgag:n.isgag},n.user)),console.log(t),localStorage.setItem("groupsMembers"+e,JSON.stringify(t))})})];case 1:return n.sent(),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}})})},t.groupsMembers=function(){return r.b(t,void 0,void 0,function(){var e=this;return r.e(this,function(t){try{u.a.usersGroups.forEach(function(t){e.groupsMember(t.id)})}catch(e){}return[2]})})},t.clearConversations=function(){return r.b(t,void 0,void 0,function(){var e=this;return r.e(this,function(t){return RongIMLib.RongIMClient.getInstance().clearConversations({onSuccess:function(){setTimeout(function(){e.GetConversationsList()},1e3)},onError:function(e){}}),[2]})})},t.groupsRegusers=function(e){return r.b(t,void 0,void 0,function(){var t=this;return r.e(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),console.log(e),[4,this.api.group.groupsRegusers(e)];case 1:return n.sent(),Object(o.runInAction)("removegroupsRegusers",function(){t.groupsMember(e.groupid),t.$message.success("移除群员成功!")}),[3,3];case 2:return n.sent(),Object(o.runInAction)("removegroupsRegusers",function(){}),[3,3];case 3:return[2]}})})},t.getTotalUnreadCount=function(){return r.b(t,void 0,void 0,function(){var e=this;return r.e(this,function(t){return RongIMLib.RongIMClient.getInstance().getTotalUnreadCount({onSuccess:function(t){Object(o.runInAction)("SET_UNRENDCOUNT",function(){e.unreadCount=t,console.log(e.unreadCount)})},onError:function(e){}}),[2]})})},t.resethasMsg=function(){t.hasMsg=!0,t.timestamp=0},t.historyMessage=function(e){try{RongIMLib.RongIMClient.getInstance().getHistoryMessages(t.chatType.conversationType,e,t.timestamp,20,{onSuccess:function(e,n){return r.b(t,void 0,void 0,function(){var t,s=this;return r.e(this,function(i){switch(i.label){case 0:return console.log(e),0===e.length?[2]:(Object(o.runInAction)("SET_HASMSG",function(){s.hasMsg=n,s.timestamp=e[0].sentTime}),console.log(this.chatType),1!==this.chatType.conversationType?[3,1]:(e.forEach(function(e){var t=r.a({},e,{nickname:2===e.messageDirection?s.chatType.nickname:u.a.usersIndex.nickname,portraitUri:2===e.messageDirection?s.chatType.portraitUri:u.a.usersIndex.portraitUri});Object(o.runInAction)("SET_MESSAGE",function(){s.MessagesList.unshift(t),console.log(s.MessagesList)})}),[3,5]));case 1:return(t=JSON.parse(localStorage.getItem("groupsMembers"+this.chatType.targetId)))?[3,3]:[4,this.groupsMember(this.chatType.targetId).then(function(){t=JSON.parse(localStorage.getItem("groupsMembers"+s.chatType.targetId))})];case 2:i.sent(),i.label=3;case 3:return[4,e.forEach(function(e){return r.b(s,void 0,void 0,function(){var n,s,i,a=this;return r.e(this,function(c){switch(c.label){case 0:return n={},1!==e.messageDirection?[3,1]:(n.nickname=u.a.usersIndex.nickname,n.portraitUri=u.a.usersIndex.portraitUri,[3,4]);case 1:return s=t.find(function(t){return t.id===e.senderUserId}),console.log(s),s?[3,3]:[4,this.api.user.usersIndex(e.senderUserId).then(function(e){console.log(e),n.nickname=e.nickname,n.portraitUri=e.portraitUri})];case 2:return c.sent(),[3,4];case 3:n.nickname=s.nickname,n.portraitUri=s.portraitUri,c.label=4;case 4:return i=r.a({},e,n),Object(o.runInAction)("SET_MESSAGE",function(){a.MessagesList.unshift(i),console.log(a.MessagesList)}),[2]}})})})];case 4:i.sent(),i.label=5;case 5:return[2]}})})},onError:function(e){t.$message.error("获取历史消息错误，返回上一页"),p.routerStore.history.goBack()}})}catch(e){p.routerStore.history.replace("/")}},t.deleteConvList=function(e,n){RongIMLib.RongIMClient.getInstance().removeConversation(e,n,{onSuccess:function(e){t.GetConversationsList(),console.log(e)},onError:function(e){}})},t.reduceUnreadCount=function(){var e=t.ConversationsList.slice().findIndex(function(e){return e.targetId===t.chatType.targetId});if(-1!==e){var n=t.ConversationsList[e].unreadMessageCount,o=r.a({},t.ConversationsList[e],{unreadMessageCount:0});t.ConversationsList.splice(e,1,o),t.unreadCount-=n}},t.clearUnreadCount=function(e){RongIMLib.RongIMClient.getInstance().clearUnreadCount(e.conversationType,e.targetId,{onSuccess:function(){console.log("清除消息成功")},onError:function(e){}})},t.getUnreadCount=function(e){RongIMLib.RongIMClient.getInstance().getUnreadCount(e.conversationType,e.targetId,{onSuccess:function(e){Object(o.runInAction)(function(){t.unreadCount+=e}),console.log(e)},onError:function(){}})},t.setChatType=function(e){t.chatType=e},t.resetMessage=function(){t.MessagesList=[]},t.resetConversationsList=function(){t.ConversationsList=[]},t.sendRecallMessage=function(e){var n=t.MessagesList.findIndex(function(t){return t.messageUId===e.messageUId});RongIMLib.RongIMClient.getInstance().sendRecallMessage(e,{onSuccess:function(e){t.sendInforMessageSDK(u.a.usersIndex.nickname+"撤回了一条消息"),Object(o.runInAction)(function(){t.MessagesList.splice(n,1)}),console.log("撤回成功",e)},onError:function(){console.log("撤回失败")},onBefore:function(e){console.log(e)}})},t.groupssetGroupRole=function(e){return r.b(t,void 0,void 0,function(){var t,n=this;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.group.groupssetGroupRole(e)];case 1:return t=r.sent(),Object(o.runInAction)(function(){console.log(t),n.$message.success("设置群管理成功"),n.groupsMember(n.chatType.targetId)}),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})})},t.playVoice=function(e,t){RongIMLib.RongIMVoice.preLoaded(e,function(){RongIMLib.RongIMVoice.play(e,t)})},t.stopVoice=function(e){RongIMLib.RongIMVoice.stop(e)},t.pullMessage=function(e){t.MessagesList.push(e)},t.pushMessage=function(e){t.MessagesList.push(e),t.refreshConversationsList(e,!0)},t.pushMessage1=function(e){t.MessagesList.push(e),t.refreshConversationsList1(e,1)},t.putActiveChat=function(e){t.activeChat=e},t.refreshConversationsList=function(e,n){var r,o=t.ConversationsList.findIndex(function(t){return t.targetId===e.targetId});console.log(e),console.log(t.chatType.portraitUri),r={conversationType:n?t.chatType.conversationType:e.conversationType,content:e.content,messageDirection:1,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:n?0:e.unreadMessageCount,portraitUri:n?t.chatType.portraitUri:e.portraitUri,nickname:n?t.chatType.nickname:e.nickname},-1===o?t.ConversationsList.push(r):t.ConversationsList.splice(o,1,r)},t.refreshConversationsList1=function(e,n){var r,o=t.ConversationsList.findIndex(function(t){return t.targetId===e.targetId});console.log(n),r={conversationType:3,content:e.content,messageDirection:1,senderUserId:e.senderUserId,targetId:e.targetId,sentTime:e.sentTime,unreadMessageCount:0,portraitUri:n.portraitUri,nickname:n.nickname||n.name},-1===o?t.ConversationsList.push(r):t.ConversationsList.splice(o,1,r)},t.yijianxiufu=function(){localStorage.clear(),Object(d.a)("token"),p.routerStore.replace("/login"),location.reload()},t.disconnect=function(){RongIMLib.RongIMClient.getInstance().disconnect()},t.reconnect=function(){var e={onSuccess:function(e){console.log("Reconnect successfully."+e),t.$message.success("重新连接成功！")},onTokenIncorrect:function(){console.log("token无效"),t.$message.error("token无效")},onError:function(e){console.log(e)}};RongIMLib.RongIMClient.reconnect(e,{auto:!0,url:"cdn.ronghub.com/RongIMLib-2.2.6.min.js",rate:[100,1e3,3e3,6e3,1e4]})},t}return r.d(t,e),Object.defineProperty(t.prototype,"getAllUnreadCount",{get:function(){return this.ConversationsList.reduce(function(e,t){return e+t.unreadMessageCount},0)},enumerable:!0,configurable:!0}),r.c([o.observable],t.prototype,"userInfo",void 0),r.c([o.observable],t.prototype,"ConversationsList",void 0),r.c([o.observable],t.prototype,"TopConversationsList",void 0),r.c([o.observable],t.prototype,"MessagesList",void 0),r.c([o.observable],t.prototype,"chatType",void 0),r.c([o.observable],t.prototype,"activeChat",void 0),r.c([o.observable],t.prototype,"unreadMessageCount",void 0),r.c([o.observable],t.prototype,"unreadCount",void 0),r.c([o.observable],t.prototype,"timestamp",void 0),r.c([o.observable],t.prototype,"hasMsg",void 0),r.c([o.observable],t.prototype,"initEnd",void 0),r.c([o.observable],t.prototype,"innerHeight",void 0),r.c([o.action],t.prototype,"initSdk",void 0),r.c([Object(o.action)("GET_CONVDATA")],t.prototype,"GetConversationsList",void 0),r.c([o.action],t.prototype,"sendTFileMessageSDK",void 0),r.c([o.action],t.prototype,"sendTImgMessageSDK",void 0),r.c([o.action],t.prototype,"sendTextMessageSDK",void 0),r.c([o.action],t.prototype,"sendGroupsTextMessageSDK",void 0),r.c([o.action],t.prototype,"sendGroupsmentionedsMessageSDK",void 0),r.c([o.action],t.prototype,"sendInforMessageSDK",void 0),r.c([o.action],t.prototype,"groupsMember",void 0),r.c([o.action],t.prototype,"groupsMembers",void 0),r.c([o.action],t.prototype,"clearConversations",void 0),r.c([o.action],t.prototype,"groupsRegusers",void 0),r.c([o.action],t.prototype,"getTotalUnreadCount",void 0),r.c([o.action],t.prototype,"resethasMsg",void 0),r.c([o.action],t.prototype,"historyMessage",void 0),r.c([o.action],t.prototype,"deleteConvList",void 0),r.c([o.action],t.prototype,"reduceUnreadCount",void 0),r.c([o.action],t.prototype,"clearUnreadCount",void 0),r.c([o.computed],t.prototype,"getAllUnreadCount",null),r.c([o.action],t.prototype,"getUnreadCount",void 0),r.c([o.action],t.prototype,"setChatType",void 0),r.c([o.action],t.prototype,"resetMessage",void 0),r.c([o.action],t.prototype,"resetConversationsList",void 0),r.c([o.action],t.prototype,"sendRecallMessage",void 0),r.c([o.action],t.prototype,"groupssetGroupRole",void 0),r.c([o.action],t.prototype,"playVoice",void 0),r.c([o.action],t.prototype,"stopVoice",void 0),r.c([o.action],t.prototype,"pullMessage",void 0),r.c([o.action],t.prototype,"pushMessage",void 0),r.c([o.action],t.prototype,"pushMessage1",void 0),r.c([o.action],t.prototype,"putActiveChat",void 0),r.c([o.action],t.prototype,"refreshConversationsList",void 0),r.c([o.action],t.prototype,"refreshConversationsList1",void 0),r.c([o.action],t.prototype,"yijianxiufu",void 0),r.c([o.action],t.prototype,"disconnect",void 0),r.c([o.action],t.prototype,"reconnect",void 0),t}(s.b);const g=new l;t.a=g,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(l,"RongStore","C:/project/svn/svn/web2-react/src/store/rongImStore/index.ts"),t.register(g,"default","C:/project/svn/svn/web2-react/src/store/rongImStore/index.ts"),r(e))}()}).call(this,n(44)(e))},254:function(e,t,n){"use strict";n.r(t);var r=n(305);n.d(t,"auth",function(){return r.a});var o=n(326);n.d(t,"user",function(){return o.a});var s=n(327);n.d(t,"group",function(){return s.a});var i=n(328);n.d(t,"single",function(){return i.a})},303:function(e,t,n){"use strict";(function(e){var r=n(1),o=n(187);!function(){var t=n(16).enterModule;t&&t(e)}();var s=function(){return r.createElement("div",{className:o.centered},r.createElement("div",{className:o.emoji},"😭"),r.createElement("p",{className:o.title},"糟糕!"),r.createElement("p",null,"该页面似乎飞往其他星球了."))};const i=s;t.a=i,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(s,"Error","C:/project/svn/svn/web2-react/src/components/Error/index.tsx"),t.register(i,"default","C:/project/svn/svn/web2-react/src/components/Error/index.tsx"),r(e))}()}).call(this,n(44)(e))},305:function(e,t,n){"use strict";(function(e){var r=n(19);!function(){var t=n(16).enterModule;t&&t(e)}();const o={login:function(e){return r.a.post("/login/login",e||{})},refreshSign:function(e){return r.a.post("/login/refreshSign",e||{})},register:function(e){return r.a.post("/login/register",e||{})},resetPassword:function(e){return r.a.post("/login/reset_password",e||{})},verifyCode:function(e){return r.a.post("/login/verify_code",e||{})},sendCode:function(e){return r.a.post("/login/send_code",e||{})},logout:function(e){return r.a.post("/login/logout",e||{})},refresh:function(e){return r.a.post("/users/refresh",e||{})},addblacklist:function(e){return r.a.post("/users/addblacklist",e||{})},removeblacklist:function(e){return r.a.post("/users/removeblacklist",e||{})},queryFriendship:function(e){return r.a.post("/friendship/queryFriendship",e||{})},confirmFriend:function(e){return r.a.post("/friendship/confirmFriend",e||{})},addFriendship:function(e){return r.a.post("/friendship/addFriendship",e||{})}};t.a=o,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(o,"default","C:/project/svn/svn/web2-react/src/services/api/auth.ts"),r(e))}()}).call(this,n(44)(e))},326:function(e,t,n){"use strict";(function(e){var r=n(19);!function(){var t=n(16).enterModule;t&&t(e)}();const o={userRePwd:function(e){return r.a.post("/users/repassword",e||{})},usersIndex:function(e){return r.a.get("/users/index/"+e,{})},friendshipAll:function(e){return r.a.post("/friendship/all",e||{})},usersBlacklist:function(e){return r.a.post("/users/blacklist",e||{})},friendApplyList:function(e){return r.a.post("/friendship/friendApplyList",e||{})},toExamineFriend:function(e){return r.a.post("/friendship/toExamineFriend",e||{})},removeFriend:function(e){return r.a.post("/friendship/removeFriend",e||{})},uploadImg:function(e){return r.a.post("/Messages/uploadImg",e||{})},uploadFile:function(e){return r.a.post("/Messages/uploadFile",e||{})},checkMessage:function(e){return r.a.post("/Messages/checkMessage",e||{})},updatedisplayName:function(e){return r.a.post("/Friendship/updatedisplayName",e||{})}};t.a=o,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(o,"default","C:/project/svn/svn/web2-react/src/services/api/user.ts"),r(e))}()}).call(this,n(44)(e))},327:function(e,t,n){"use strict";(function(e){var r=n(19);!function(){var t=n(16).enterModule;t&&t(e)}();const o={usersGroups:function(e){return r.a.post("/users/groups",e||{})},groupsMembers:function(e){return r.a.get("/groups/members/"+e,{})},groupWritten:function(e){return r.a.post("/messages/groupWritten",e||{})},groupImgMsg:function(e){return r.a.post("/messages/groupImgMsg",e||{})},groupFileMsg:function(e){return r.a.post("/messages/groupFileMsg",e||{})},groupsCreate:function(e){return r.a.post("/groups/create",e||{})},groupsJoin:function(e){return r.a.post("/groups/join",e||{})},groupsQuit:function(e){return r.a.post("/groups/quit",e||{})},groupsDismiss:function(e){return r.a.post("/groups/dismiss",e||{})},groupDismiss:function(e){return r.a.post("/group/dismiss",e||{})},groupsRefresh:function(e){return r.a.post("/groups/refresh",e||{})},groupsGroupUser:function(e){return r.a.post("/groups/groupUser",e||{})},groupsRegusers:function(e){return r.a.post("/groups/regusers",e||{})},groupsGroupInfo:function(e){return r.a.get("/groups/groupInfo/"+e,{})},groupsaddGagUser:function(e){return r.a.post("/Groups/addGagUser",e||{})},groupsrollBackGagUser:function(e){return r.a.post("/Groups/rollBackGagUser",e||{})},groupslisGagUser:function(e){return r.a.post("/Groups/lisGagUser",e||{})},groupssetGroupRole:function(e){return r.a.post("/Groups/setGroupRole",e||{})},groupsgroupRole:function(e){return r.a.post("/Groups/groupRole",e||{})}};t.a=o,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(o,"default","C:/project/svn/svn/web2-react/src/services/api/group.ts"),r(e))}()}).call(this,n(44)(e))},328:function(e,t,n){"use strict";(function(e){var r=n(19);!function(){var t=n(16).enterModule;t&&t(e)}();const o={usersIndex:function(e){return r.a.get("/users/index/"+e,{})},messagesWritten:function(e){return r.a.post("/messages/written",e||{})},messagesImgMsg:function(e){return r.a.post("/messages/imgMsg",e||{})},messagesFileMsg:function(e){return r.a.post("/messages/fileMsg",e||{})},setNotification:function(e){return r.a.post("/Notification/setNotification",e||{})},getNotification:function(e){return r.a.post("/Notification/getNotification",e||{})}};t.a=o,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(o,"default","C:/project/svn/svn/web2-react/src/services/api/single.ts"),r(e))}()}).call(this,n(44)(e))},329:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(3),s=n(59),i=n(43);!function(){var t=n(16).enterModule;t&&t(e)}();var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sideBarCollapsed="1"===localStorage.getItem(i.b.SIDE_BAR_COLLAPSED),t.sideBarTheme=localStorage.getItem(i.b.SIDE_BAR_THEME)||"light",t.navOpenKeys=JSON.parse(localStorage.getItem(i.b.NAV_OPEN_KEYS))||[],t.toggleSideBarCollapsed=function(){t.sideBarCollapsed=!t.sideBarCollapsed,localStorage.setItem(i.b.SIDE_BAR_COLLAPSED,t.sideBarCollapsed?"1":"0")},t.changeSiderTheme=function(e){t.sideBarTheme=e,localStorage.setItem(i.b.SIDE_BAR_THEME,e)},t.setOpenKeys=function(e){t.navOpenKeys=e,localStorage.setItem(i.b.NAV_OPEN_KEYS,JSON.stringify(e))},t}return r.d(t,e),r.c([o.observable],t.prototype,"sideBarCollapsed",void 0),r.c([o.observable],t.prototype,"sideBarTheme",void 0),r.c([o.observable],t.prototype,"navOpenKeys",void 0),r.c([o.action],t.prototype,"toggleSideBarCollapsed",void 0),r.c([o.action],t.prototype,"changeSiderTheme",void 0),r.c([o.action],t.prototype,"setOpenKeys",void 0),t}(s.b);const c=new a;t.a=c,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(a,"GlobalStore","C:/project/svn/svn/web2-react/src/store/globalStore/index.ts"),t.register(c,"default","C:/project/svn/svn/web2-react/src/store/globalStore/index.ts"),r(e))}()}).call(this,n(44)(e))},330:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(3),s=n(59),i=n(38),a=n(49),c=n(43),u=n(178),p=n.n(u),d=n(179),l=n(20);!function(){var t=n(16).enterModule;t&&t(e)}();var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfo=null,t.login=function(e){return r.b(t,void 0,Promise,function(){var t,n,s,u=this;return r.e(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),[4,this.api.auth.login(e)];case 1:return t=p.sent(),console.log(t),Object(o.runInAction)("SET_USERINFO",function(){u.userInfo=t}),Object(a.d)(c.a.TOKEN,t.token),n=Math.round((new Date).getTime()),console.log(n),localStorage.setItem(c.b.USERINFO,JSON.stringify(r.a({},t,{date:n}))),i.routerStore.replace("/"),[3,3];case 2:return s=p.sent(),console.error(s),[3,3];case 3:return[2]}})})},t.refreshSign=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.refreshSign(e)];case 1:return t=r.sent(),console.log(t),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t.register=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.register(e)];case 1:return t=r.sent(),this.$message.success("注册成功"),console.log(t),i.routerStore.replace("/login"),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t.resetPassword=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.resetPassword(e)];case 1:return t=r.sent(),this.$message.success("重置密码成功"),console.log(t),i.routerStore.replace("/login"),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t.userRePwd=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.user.userRePwd(e)];case 1:return t=r.sent(),this.$message.success("重置密码成功"),console.log(t),i.routerStore.replace("/"),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t.verifyCode=function(e){return t.api.auth.verifyCode(e)},t.sendCode=function(e){return r.b(t,void 0,Promise,function(){var t,n;return r.e(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.api.auth.sendCode(e)];case 1:return t=r.sent(),console.log(t),[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},t.uploadImg=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){return p.a.get("https://picsum.photos/200/300/?random",{responseType:"blob"}).then(function(e){console.log(e);var t=new File(e.data,"1.jpg");d.a.messagesImgMsg({friendid:"9",file:t})}),[2]})})},t.logout=function(){return r.b(t,void 0,void 0,function(){return r.e(this,function(e){switch(e.label){case 0:Object(a.a)(c.a.TOKEN),localStorage.removeItem(c.b.USERINFO),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.api.auth.logout({userid:l.a.usersIndex.id})];case 2:return e.sent(),i.routerStore.replace("/login"),location.reload(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})})},t.initUserInfo=function(){var e=localStorage.getItem(c.b.USERINFO);if(!e)throw new Error("no local userinfo!!");var n=JSON.parse(e);return t.userInfo=n,n},t}return r.d(t,e),r.c([o.observable],t.prototype,"userInfo",void 0),r.c([o.observable],t.prototype,"verification_token",void 0),r.c([o.action],t.prototype,"login",void 0),r.c([o.action],t.prototype,"refreshSign",void 0),r.c([o.action],t.prototype,"register",void 0),r.c([o.action],t.prototype,"resetPassword",void 0),r.c([o.action],t.prototype,"userRePwd",void 0),r.c([o.action],t.prototype,"verifyCode",void 0),r.c([o.action],t.prototype,"sendCode",void 0),r.c([o.action],t.prototype,"uploadImg",void 0),r.c([o.action],t.prototype,"logout",void 0),r.c([o.action],t.prototype,"initUserInfo",void 0),t}(s.b);const f=new g;t.a=f,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(g,"AuthStore","C:/project/svn/svn/web2-react/src/store/authStore/index.ts"),t.register(f,"default","C:/project/svn/svn/web2-react/src/store/authStore/index.ts"),r(e))}()}).call(this,n(44)(e))},38:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"routerStore",function(){return u});var r=n(180),o=n(329);n.d(t,"globalStore",function(){return o.a});var s=n(330);n.d(t,"authStore",function(){return s.a});var i=n(20);n.d(t,"userStore",function(){return i.a});var a=n(22);n.d(t,"rongStore",function(){return a.a});var c=n(179);n.d(t,"messageStore",function(){return c.a}),function(){var t=n(16).enterModule;t&&t(e)}();var u=new r.RouterStore;!function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(u,"routerStore","C:/project/svn/svn/web2-react/src/store/index.ts"),r(e))}()}.call(this,n(44)(e))},414:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(1),s=n(16),i=n(136),a=n.n(i),c=n(1144),u=n(1145),p=n(97),d=n(415),l=n(137),g=n(303),f=n(418);!function(){var t=n(16).enterModule;t&&t(e)}();var v=a()({loader:function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,1175))},loading:l.a}),h=a()({loader:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,1178))},loading:l.a}),I=a()({loader:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,1179))},loading:l.a}),b=a()({loader:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,1180))},loading:l.a}),m=function(e){return o.createElement("div",{className:d.appWrapper},e.children)},y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.d(t,e),t.prototype.render=function(){return o.createElement(m,null,o.createElement(c.a,null,o.createElement(u.a,null,o.createElement(p.a,{exact:!0,path:"/login",component:h}),o.createElement(p.a,{exact:!0,path:"/register",component:I}),o.createElement(p.a,{exact:!0,path:"/forgetpwd",component:b}),o.createElement(f.a,{path:"/",component:v}),o.createElement(p.a,{component:g.a}))))},t}(o.Component);const C=Object(s.hot)(e)(y);t.a=C,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(v,"Home","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(h,"Login","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(I,"register","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(b,"forgetpwd","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(m,"AppWrapper","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(y,"AppRouter","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),t.register(C,"default","C:/project/svn/svn/web2-react/src/containers/shared/App/index.tsx"),r(e))}()}).call(this,n(44)(e))},415:function(e,t,n){e.exports={appWrapper:"_3Ndwn1769-PHbenrbYaD4B"}},418:function(e,t,n){"use strict";(function(e){var r=n(2),o=n(1),s=n(112),i=n(97),a=n(59),c=n(49),u=n(43);!function(){var t=n(16).enterModule;t&&t(e)}();var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gotoLogin=function(){t.props.routerStore.history.replace("/login")},t.checkLocalUserInfo=function(){var e=Object(c.b)(u.a.TOKEN);if(!e)return t.gotoLogin();var n=t.props,r=n.userInfo,o=n.initUserInfo;if((0,n.getUsers)(),!r)try{if(o().token!==e)throw new Error("cookie 上储存的token与localStorage 上储存的token不一致!")}catch(e){console.warn(e),t.gotoLogin()}},t}return r.d(t,e),t.prototype.componentDidMount=function(){this.checkLocalUserInfo()},t.prototype.render=function(){var e=this.props,t=e.component,n=r.f(e,["component"]);return o.createElement(i.a,r.a({},n,{render:function(e){return o.createElement(t,r.a({},n))}}))},t=r.c([Object(s.b)(function(e){var t=e.routerStore,n=e.authStore,r=e.userStore;return{routerStore:t,userInfo:n.userInfo,initUserInfo:n.initUserInfo,getUsers:r.getUsers}}),s.c],t)}(a.a);const d=p;t.a=d,function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(p,"PrivateRoute","C:/project/svn/svn/web2-react/src/containers/shared/PrivateRoute/index.tsx"),t.register(d,"default","C:/project/svn/svn/web2-react/src/containers/shared/PrivateRoute/index.tsx"),r(e))}()}).call(this,n(44)(e))},43:function(e,t,n){"use strict";(function(e){var r,o;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),function(){var t=n(16).enterModule;t&&t(e)}(),function(e){e.TOKEN="token",e.SIGN="sign"}(r||(r={})),function(e){e.USERINFO="userInfo",e.NAV_OPEN_KEYS="navOpenKeys",e.SIDE_BAR_THEME="sideBarTheme",e.SIDE_BAR_COLLAPSED="sideBarCollapsed"}(o||(o={}));var s=["user","admin"];!function(){var t=n(16).default,i=n(16).leaveModule;t&&(t.register(r,"COOKIE_KEYS","C:/project/svn/svn/web2-react/src/constants/index.ts"),t.register(o,"LOCALSTORAGE_KEYS","C:/project/svn/svn/web2-react/src/constants/index.ts"),t.register(s,"LOGIN_CATEGORY","C:/project/svn/svn/web2-react/src/constants/index.ts"),i(e))}()}).call(this,n(44)(e))},49:function(e,t,n){"use strict";(function(e){n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return p});var r=n(420);function o(e,t,n){void 0===n&&(n=365);var r=new Date;r.setDate(r.getDate()+n),document.cookie=e+"="+escape(t)+";expires="+r.toUTCString()}function s(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var n=document.cookie.indexOf(";",t);return-1===n&&(n=document.cookie.length),unescape(document.cookie.substring(t,n))}}return""}function i(e){o(e,"")}function a(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!==n?decodeURI(n[2]):null}function c(e,t,n){if(void 0===n&&(n="key"),!(e instanceof Array))return null;var r=e.filter(function(e){return e[n]===t});return r.length?r[0]:null}function u(e,t,n,o){void 0===t&&(t="id"),void 0===n&&(n="pid"),void 0===o&&(o="children");var s=Object(r.cloneDeep)(e),i=[],a={};return s.forEach(function(e,n){a[s[n][t]]=s[n]}),s.forEach(function(e){var t=a[e[n]];t?(t[o]||(t[o]=[]),t[o].push(e)):i.push(e)}),i}function p(){var e=JSON.parse(localStorage.getItem("userInfo"));return e||""}!function(){var t=n(16).enterModule;t&&t(e)}();var d=!![].map&&0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp");!function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(o,"setCookie","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(s,"getCookie","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(i,"clearCookie","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(a,"queryURL","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(c,"queryArray","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(u,"arrayToTree","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(p,"getSign","C:/project/svn/svn/web2-react/src/utils/index.ts"),t.register(d,"isSupportWebp","C:/project/svn/svn/web2-react/src/utils/index.ts"),r(e))}()}).call(this,n(44)(e))},505:function(e,t,n){n(506),e.exports=n(623)},59:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return p}),n.d(t,"b",function(){return d});var r=n(2),o=n(1),s=n(80),i=n.n(s),a=(n(260),n(96)),c=n.n(a),u=(n(304),n(254));!function(){var t=n(16).enterModule;t&&t(e)}();var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.api=u,t.$message=i.a,t.$notification=c.a,t}return r.d(t,e),t}(o.Component),d=function(){return function(){this.api=u,this.$message=i.a,this.$notification=c.a}}();!function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(p,"ComponentExt","C:/project/svn/svn/web2-react/src/utils/reactExt.tsx"),t.register(d,"StoreExt","C:/project/svn/svn/web2-react/src/utils/reactExt.tsx"),r(e))}()}).call(this,n(44)(e))},623:function(e,t,n){"use strict";n.r(t),function(e){var t=n(2),r=(n(626),n(1)),o=n(11),s=n(112),i=n(3),a=n(413),c=n.n(a),u=n(180),p=n(256),d=n(414),l=n(38);!function(){var t=n(16).enterModule;t&&t(e)}();var g=c()(),f=Object(u.syncHistoryWithStore)(g,l.routerStore);Object(i.configure)({enforceActions:"observed"});var v=function(e){o.render(r.createElement(s.a,t.a({},l),r.createElement(p.a,{history:f},r.createElement(e,null))),document.getElementById("app"))};v(d.a),function(){var t=n(16).default,r=n(16).leaveModule;t&&(t.register(g,"hashHistory","C:/project/svn/svn/web2-react/src/index.tsx"),t.register(f,"history","C:/project/svn/svn/web2-react/src/index.tsx"),t.register(v,"render","C:/project/svn/svn/web2-react/src/index.tsx"),r(e))}()}.call(this,n(44)(e))},626:function(e,t,n){}},[[505,5,0]]]);